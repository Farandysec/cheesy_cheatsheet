PENTEST
Pentest

FOR OSCP
(local.txt & proof.txt)


##############
####CHECKS####
##############
#
# RUN BURP, FTP, PROGRESSQL, TEST METASPLOIT, APACHE2
# RUN WIRESHARK!!!
#
#STAGES: 
#
#HOST DISCOVERY
#HOST PORT SCAN (TCP, UDP)
#HOST VULN SCAN (WEIRD PORTS, SMB, WEB, CLI, RDP, SNMP, APACHE, CMS, WINDOWS, LINUX)
#HOST WEB VULN SCAN (BURP, NIKTO, DIRB, NMAP HTTP AND WP FOR EACH ITEM)

############
####NMAP####
############
#START WITH A SWEEP SCAN
#
nmap -sn x.x.x.x
#
#
#THEN GO FOR A STANDARD SCAN
#
nmap x.x.x.x -T3 > nmap_standard_scan
#
#
#THEN GO FOR A SCRIPT SCAN PER IP!! OTHERWISE IT MIGHT BE TOO MUCH TRAFFIC
#
nmap x.x.x.x -A > nmap_script_scan
#
#
#REMEMBER TO RUN A UDP SCAN AS WELL!!!
#
nmap x.x.x.x -sU > nmap_udp_scan
#
#DO A VULNERABILITY SCANNER
#
cat list_of_targets | while read line; do nmap $line --script vuln; done > scan_vuln
nmap -A -O -iL new_list_of_targets --script vuln -oG new_port_scan -sU > new_vuln_scan 
#
#
#DO SCAN NON STANDARD PORTS
nmap x.x.x.x -p 1-65535
#
#
############
####SMB#####
############
#
#START WITH A BASIC SCAN
#
nbtscan x.x.x.x 
#
#PROGRESS WITH A VERBOSE SCAN for the full network
#
for (( i=0; i<=254; i++ )) ; do enum4linux -v 10.11.1."$i" > enum4linux_scan_"$i" ; done
#
#NMAP SMB SCAN
#
nmap -v -p 139,445 --script "smb*"  x.x.x.x > nmap_smb_scan
#
#NMAP VULN SCAN
#
nmap -v -p 139,445 --script=smb-vuln-ms08-067 --script-args=unsafe=1 10.11.1.1-254 > nmap_smbvuln_scan
nmap --script vuln 10.11.1.5
#
nmap --script smb x.x.x.x > nmap_smb_scan
#
#
#
#############
####SNMP#####
#############
#
#RUN SNMP SCAN
#
onesixtyone -c snmp_community -i ips
snmpwalk -c public -v1 10.11.1.73
snmp-check 10.11.1.73 -c public
#
###############
####OTHERS#####
###############
#
#RUN MAIL VRFY BRUTE FORCE
#
python vrfy.py user_list
#SCAN FOR OPEN FTP SERVERS (CHECK OTHER EASYONES!!!!)
#
#
nmap -v -p 21 --script=ftp.anon.nse 10.11.1.1-254 > ftp_anon
#
#
#
Run Hydra over the whole network to do a spray and brute force attack.
#
#
FTP ANONYMOUS LOGIN WITH anonymous or ftp
#
#############
####WEB#####
#############
#
#
#nmap --script http 10.11.1.14
#nikto -host 10.11.1.14
#dirb http://10.11.1.14/
#
#
#START RUNNING A NMAP AND NIKTO SCANS (OPEN BURP, GO TO PROJECT OPIONS AND ACTIVATE THE SCOPE CONTROL) THEN START BURP AS USUAL
#
cat list_of_targets | while read line; do nmap $line --script http; done > scan_vuln
cat list_of_targets | while read line; do nikto -host $line;  done > scan_vuln2
#
#
#
#
REMEMBER TO LOOK FOR WP AND JOOMLA
#
###########################################################################
SMB/WINDOWS EXPLOITATION
###########################################################################
BRUTE FORCE RDP 
ncrack -vv --user offsec -P password-file.txt rdp://10.11.1.35
#
#
REMEMBER TO CHECK DEFAULT PASSWORDS
#
###############
####LATMOV#####
###############

Use fgdump on your Windows system.
Use WCE on your Windows system.
Use mimikaztz on your Windows system.
unshadow passwd-file.txt shadow-file.txt > unshadowed.txt FOR WINDOWS PASSWORD FILES ---> PWK PDF PAGE 285
hashdump on meterpreter

# AND IMPORTANT,...CHECK THE PASSWORD POLICY TO DECREASE THE TIME

THEN... Put the Usernames and Passwords on 2 files...and get john ready to crack
once it's cracked, then you can use it with hydra

cat list_of_targets | while read line; do hydra -L usernames_smb -P passwords_smb $line smb > hydra_$line; done

REMEMBER TO RE-SCAN THE FILTERED PORTS FROM THE COMPROMISED MACHINES...SOMETHING NEW MIGHT BE AVAILABLE





